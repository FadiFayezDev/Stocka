# ?? ????? Migration: SeedRoles

## ? ??????: ????? ?????

---

## ?? ??????? ???????

?????:
```
There is no property mapped to the column 'AspNetRoles.Id' which is used in a data operation. 
Either add a property mapped to this column, or specify the column types in the data operation.
```

**?????:**
Migration ??? ?????? ????? ??????? ????? **PascalCase**:
```csharp
columns: new[] { "Id", "ConcurrencyStamp", "Name", "NormalizedName" }
```

??? ????? ???????? ?????? **snake_case** ???? `UseSnakeCaseNamingConvention()`.

---

## ? ????

### ?? ????? ?????:
```
Infrastructure\Migrations\20260218020948_SeedRoles.cs
```

### ?????????:

#### 1?? ????? ??????? (Up Method):
```csharp
// ? ???:
columns: new[] { "Id", "ConcurrencyStamp", "Name", "NormalizedName" }

// ? ???:
columns: new[] { "id", "concurrency_stamp", "name", "normalized_name" }
```

#### 2?? ??? ?????? (Down Method):
```csharp
// ? ???:
migrationBuilder.Sql("DELETE FROM \"AspNetRoles\"");

// ? ???:
migrationBuilder.Sql("DELETE FROM \"asp_net_roles\"");
```

---

## ?? ????????

### ???? AspNetRoles ????????:

| ??????? | ????? ??????? ?? DB | ????????? |
|---|---|---|
| Id | `id` | ????? ???? |
| ConcurrencyStamp | `concurrency_stamp` | ?????? ??????? |
| Name | `name` | ??? ????? |
| NormalizedName | `normalized_name` | ??? ?????? |

---

## ?? ??? ???? ???????

### ???:
```csharp
migrationBuilder.InsertData(
    table: "AspNetRoles",
    columns: new[] { "Id", "ConcurrencyStamp", "Name", "NormalizedName" },
    values: roles
);

migrationBuilder.Sql("DELETE FROM \"AspNetRoles\"");
```

### ???:
```csharp
migrationBuilder.InsertData(
    table: "AspNetRoles",
    columns: new[] { "id", "concurrency_stamp", "name", "normalized_name" },
    values: roles
);

migrationBuilder.Sql("DELETE FROM \"asp_net_roles\"");
```

---

## ? ???????

? **????????? ???????** ?? `UseSnakeCaseNamingConvention()`  
? **?? ???? ?????** ??? ????? ??? Migration  
? **???????? ????? ???? ????** ?? ???? `asp_net_roles`  
? **?????? ????? ???? ???? ????**  

---

## ??? ?????? ??????

??? ??????? ??? ?? ????? ???? ?? **snake_case Convention**:

### ????????? ?????? ????????:
1. ? Dapper Query Repositories (21 ???)
2. ? Entity Framework Configurations (22 ???)
3. ? Database Migration (20260218013438)
4. ? SeedRoles Migration (20260218020948) ? **??????? ??????**

---

## ?? ??? Migration ??????

```csharp
using Domain.Enums;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace Infrastructure.Migrations
{
    /// <inheritdoc />
    public partial class SeedRoles : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            string[] roleNames = Enum.GetNames(typeof(SystemRolesType));

            var roles = new object[roleNames.Length, 4];

            for (int i = 0; i < roleNames.Length; i++)
            {
                roles[i, 0] = Guid.NewGuid().ToString();
                roles[i, 1] = Guid.NewGuid().ToString();
                roles[i, 2] = roleNames[i];
                roles[i, 3] = roleNames[i].ToUpper();
            }

            migrationBuilder.InsertData(
                table: "AspNetRoles",
                columns: new[] { "id", "concurrency_stamp", "name", "normalized_name" },
                values: roles
             );
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.Sql("DELETE FROM \"asp_net_roles\"");
        }
    }
}
```

---

## ?? ????????

```
? ??????: ??? ???? ?????
? Migration: ????? ???????
? ?????????: ????? ?? snake_case
```

---

## ?? ??????? ????????

- `Infrastructure\Migrations\20260218013438_UseSnakeCaseNamingConvention.cs` - ??? Migration ???????
- `Infrastructure\Contexts\AppDbContext.cs` - DbContext ?? snake_case convention
- `Domain\Enums\SystemRolesType.cs` - ????? ????? ???????

---

**???????:** ????  
**??????:** ? ?????  

?? **?? ?? ??????? ?????**

