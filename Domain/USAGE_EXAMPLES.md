# ????? ????????? - Usage Examples

## 1. ?? Expense Management

### ????? Expense:
```csharp
// ? ?????? - ???? validation
var expense = new Expense();
expense.Amount = -500; // ?? ???? ????!
expense.CategoryId = Guid.Empty; // ?? ???? ?????

// ? ?????? - ?? validation
var expense = new Expense(
    brandId: brandId,
    categoryId: categoryId,
    amount: 500,
    expenseDate: DateTime.UtcNow,
    notes: "Office supplies"
);

// ????? ??? ??? ?????? <= 0
try
{
    var invalidExpense = new Expense(brandId, categoryId, -500);
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Expense amount must be greater than zero."
}
```

### ????? Expense:
```csharp
// ????? ?????? ?? validation
expense.UpdateAmount(750);

// ????? ?????????
expense.UpdateNotes("Updated office supplies order");

// ????? ??????? ?? ?????? ?? ??? ??? ?? ????????
expense.UpdateExpenseDate(DateTime.UtcNow.AddDays(-1)); // ? ????
// expense.UpdateExpenseDate(DateTime.UtcNow.AddDays(1)); // ? ?????
```

---

## 2. ?? Customer Loyalty Points

### ????? Customer:
```csharp
// ????? customer ???? ?? ???? ?????
var customer = new Customer(
    userId: userId,
    brandId: brandId,
    initialLoyaltyPoints: 100
);

// ?? ???? ???? ?????
var newCustomer = new Customer(userId: null, brandId: brandId);
```

### ????? Loyalty Points:
```csharp
var customer = new Customer(userId, brandId, initialLoyaltyPoints: 100);

// ????? ????
customer.AddLoyaltyPoints(50); // ???? ????? 150 ????

// ?????? ????? ???? ??? ?????
try
{
    customer.AddLoyaltyPoints(-50); // ? ?????
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Points to add must be greater than zero."
}

// ??? ????
customer.DeductLoyaltyPoints(30); // ???? ????? 120 ????

// ?????? ??? ???? ?? ??????
try
{
    customer.DeductLoyaltyPoints(150); // ? ?????
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Insufficient loyalty points."
}
```

---

## 3. ?? Inventory Management

### ????? Batch:
```csharp
// ????? batch ???? ?? ????????
var batch = new Batch(
    productId: productId,
    purchaseItemId: purchaseItemId,
    brandId: brandId,
    initialQuantity: 100,
    unitCost: 50m
);

// ?????? ?? ???????
Console.WriteLine($"Initial Qty: {batch.InitialQuantity}"); // 100
Console.WriteLine($"Remaining Qty: {batch.RemainingQuantity}"); // 100
Console.WriteLine($"Total Cost: {batch.GetTotalCost()}"); // 5000

// ?????? ????? batch ????? ??? ?????
try
{
    var invalidBatch = new Batch(productId, purchaseItemId, brandId, 0, 50);
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Initial quantity must be greater than zero."
}
```

### ????? ???????:
```csharp
var batch = new Batch(productId, purchaseItemId, brandId, 100, 50m);

// ??? 30 ????
batch.DeductQuantity(30); // ?????? ???????? = 70

// ?????? ??? ???? ?? ??????
try
{
    batch.DeductQuantity(100); // ? ?????
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Insufficient quantity in batch."
}

// ????? ???? (??? ???????)
batch.AddQuantity(20); // ?????? ???????? = 90

// ?????? ?? ??????? ??????
if (batch.IsExhausted)
{
    Console.WriteLine("Batch is empty, remove from inventory");
}
```

---

## 4. ?? Sales Management

### ????? Sale:
```csharp
// ????? ??? ????
var sale = new Sale(
    brandId: brandId,
    employeeId: employeeId,
    customerId: customerId,
    saleDate: DateTime.UtcNow
);

// ?????? ?? ?????? ???????
Console.WriteLine($"Status: {sale.Status}"); // Completed
Console.WriteLine($"Total: {sale.TotalAmount}"); // 0
```

### ????? Items ?????:
```csharp
var sale = new Sale(brandId, employeeId, customerId);

var saleItem = new SaleItem(
    saleId: sale.Id,
    productId: productId,
    batchId: batchId,
    brandId: brandId,
    quantity: 10,
    unitPrice: 100m,
    costPrice: 50m // ??????: unitPrice >= costPrice
);

// ????? item
sale.AddSaleItem(saleItem);

// ?????? ?? ????? ???? ???????
Console.WriteLine($"Sale Total: {sale.TotalAmount}"); // 1000 (10 * 100)

// ?????? ????? item ???? ??? ??? ?? ??? ???????
try
{
    var invalidItem = new SaleItem(sale.Id, productId, batchId, brandId, 10, 40m, 50m);
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Unit price cannot be less than cost price."
}
```

### ???? ???????:
```csharp
var item = new SaleItem(sale.Id, productId, batchId, brandId, 5, 100m, 60m);

var profit = item.GetProfit(); // (100 - 60) * 5 = 200
var totalPrice = item.GetTotalPrice(); // 100 * 5 = 500

Console.WriteLine($"Profit per item: {profit}"); // 200
Console.WriteLine($"Total Price: {totalPrice}"); // 500
```

### ????? ???? ?????:
```csharp
var sale = new Sale(brandId, employeeId, customerId);
sale.AddSaleItem(saleItem);

// ????? ?????
sale.CancelSale();

// ?????? ????? item ???? ?????
try
{
    sale.AddSaleItem(anotherItem); // ? ?????
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Cannot add items to a cancelled sale."
}

// ??????? ?????
var sale2 = new Sale(brandId, employeeId, customerId);
sale2.ReturnSale();

// ?????? ??????? ??? ?????
try
{
    sale2.ReturnSale(); // ? ?????
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Cannot return a cancelled sale."
}
```

---

## 5. ?? Supplier Management

### ????? Supplier:
```csharp
// ????? supplier
var supplier = new Supplier(
    brandId: brandId,
    name: "ABC Electronics",
    phone: "123-456-7890",
    email: "info@abc.com",
    address: "123 Business Street"
);

// ?????? ????? ???? ???
try
{
    var invalidSupplier = new Supplier(brandId, "", "123-456-7890");
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Supplier name cannot be empty."
}

// ?????? ????? ????? ???????? ??? ????
try
{
    var invalidSupplier = new Supplier(brandId, "ABC Corp", email: "invalid-email");
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Invalid email format."
}
```

### ????? ?????? ???????:
```csharp
supplier.UpdateContactInfo(
    phone: "987-654-3210",
    email: "newemail@abc.com",
    address: "456 Industrial Ave"
);

// ?????? ?? ???????? ???????
Console.WriteLine($"Phone: {supplier.Phone}"); // 987-654-3210
```

---

## 6. ?? Accounting Management

### ????? Journal Entry:
```csharp
// ????? ??? ??????
var entry = new JournalEntry(
    brandId: brandId,
    entryDate: DateTime.UtcNow,
    description: "Monthly rent payment"
);

// ????? ????
var debitLine = new JournalEntryLine(
    journalEntryId: entry.Id,
    accountId: rentExpenseAccountId,
    brandId: brandId,
    debit: 1000m,
    credit: 0m
);

var creditLine = new JournalEntryLine(
    journalEntryId: entry.Id,
    accountId: bankAccountId,
    brandId: brandId,
    debit: 0m,
    credit: 1000m
);

entry.AddJournalEntryLine(debitLine);
entry.AddJournalEntryLine(creditLine);

// ?????? ?? ???????
Console.WriteLine($"Is Balanced: {entry.IsBalanced}"); // true
Console.WriteLine($"Total Debit: {entry.GetTotalDebit}"); // 1000
Console.WriteLine($"Total Credit: {entry.GetTotalCredit}"); // 1000
```

### ?????? ??? ???????:
```csharp
// ?????? ????? ??? ???? ??? ?????
var unbalancedLine = new JournalEntryLine(entry.Id, accountId, brandId, 500m, 0m);

try
{
    entry.AddJournalEntryLine(unbalancedLine);
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Journal entry must balance..."
}
```

---

## 7. ????? Employee Management

### ????? Employee:
```csharp
// ????? ???? ????
var employee = new Employee(
    userId: userId,
    brandId: brandId,
    jobTitle: "Sales Manager",
    salary: 3000m
);

// ?????? ????? ???? ???? ?????
try
{
    var invalidEmployee = new Employee(userId, brandId, "", 3000m);
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Job title cannot be empty."
}

// ?????? ????? ????? ??? ????
try
{
    var invalidEmployee = new Employee(userId, brandId, "Sales Manager", -1000m);
}
catch (ArgumentException ex)
{
    Console.WriteLine(ex.Message); // "Salary must be greater than zero."
}
```

### ????? ?????? ??????:
```csharp
var employee = new Employee(userId, brandId, "Sales Manager", 3000m);

// ????? ?????? ???????
employee.UpdateJobTitle("Senior Sales Manager");

// ????? ??????
employee.UpdateSalary(4000m);

// ????? ?????? (?????)
employee.Deactivate();

Console.WriteLine($"Is Active: {employee.IsActive}"); // false

// ?????? ????? ???? ???? ??????
try
{
    employee.Deactivate(); // ? ?????
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.Message); // "Employee is already inactive."
}

// ????? ????? ??????
employee.Activate();
```

---

## 8. ?? Warehouse Management

### ????? Warehouse:
```csharp
// ????? ??????
var warehouse = new Warehouse(
    branchId: branchId,
    brandId: brandId,
    name: "Main Warehouse",
    type: WarehouseType.Main
);

// ????? ?????
warehouse.UpdateName("Central Warehouse");

// ????? ??? ????????
warehouse.ChangeType(WarehouseType.Secondary);
```

### ????? Stock Movements:
```csharp
var movement = new StockMovement(
    productId: productId,
    batchId: batchId,
    warehouseId: warehouse.Id,
    brandId: brandId,
    quantity: 50,
    movementType: StockMovementType.PurchaseIn,
    referenceType: "Purchase",
    referenceId: purchaseId
);

warehouse.AddStockMovement(movement);

// ?????? ?? ??? ??????
Console.WriteLine($"Is Inbound: {movement.IsInbound}"); // true
Console.WriteLine($"Is Outbound: {movement.IsOutbound}"); // false
```

---

## ?? ???? ????

? **???? ???????? ????? ?? Validation**
? **??????? ????? ??????**
? **???????? ?????? ?? ???? ?????**
? **???? ???????? ??? ??? Entity state**
? **??? Business Rules ????? ?? Domain**

---

## ?? ?????? ???????

????? Application Layer commands ???????? ??? Constructors ???? Methods ???????:

```csharp
// ? ??????
public async Task<Response<ExpenseDto>> Handle(CreateExpenseCommand request)
{
    var expense = new Expense();
    expense.Amount = request.Amount; // ???? validation
    expense.CategoryId = request.CategoryId;
    await _repo.CreateAsync(expense);
}

// ? ??????
public async Task<Response<ExpenseDto>> Handle(CreateExpenseCommand request)
{
    var expense = new Expense(request.BrandId, request.CategoryId, request.Amount);
    await _repo.CreateAsync(expense);
}
```
